@using Final.Entities;
@using Final.PL.Models;
@{
    if (IsPost)
    {
        if (!User.Identity.IsAuthenticated)
        {
            Response.Redirect("~/");
            return;
        }

        var thread = AppData.ForumThreadLogic.Add(new ForumThread()
        {
            AuthorId = AppData.UserLogic.
                GetByUsername(User.Identity.Name).Id,
            Title = Request["title"],
            Message = Request["message"]
        });

        if (thread != null)
        {
            Response.Redirect("~/");
        }
    }
    else
    {
        Response.Redirect("~/");
    }
}