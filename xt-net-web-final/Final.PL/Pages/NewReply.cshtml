@using Final.Entities;
@using Final.PL.Models;
@{
    if (IsPost)
    {
        if (!User.Identity.IsAuthenticated)
        {
            Response.Redirect("~/");
            return;
        }

        var thread = AppData.ThreadPostLogic.Add(new ThreadPost()
        {
            AuthorId = AppData.UserLogic.
                GetByUsername(User.Identity.Name).Id,
            ThreadId = int.Parse(Request["threadId"]),
            Message = Request["message"]
        });

        if (thread != null)
        {
            Response.Redirect("~/");
            return;
        }
    }
    else
    {
        Response.Redirect("~/");
        return;
    }
}